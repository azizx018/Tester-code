<!DOCTYPE html>
<html>
<head>
    <title>Chiara's Project</title>
    <style>
        body {
            background-color:rgb(26, 26, 102);
            padding: 10px;
            color: white;
        }
        label {
            display:block;
            margin-bottom: 10px;
            padding: 2px;
            
        }
        input {
            display: block;
            width: 180px;
        }
        button {
            background-color:rgb(208, 135, 233);
            padding: 8px; 
            border-radius:5px;
            border-color:white;
            border-width: 1px;
            font-weight: bold;
            cursor:pointer;
        }
        h5 {            
            color:rgb(0, 255, 255);
            display: none;
            margin: 0;
        }
    </style>
</head>
<body>

<div>
    <form onsubmit="validate(event)">
        <label>
            UserID:
            <input type="text" id ="uid" name="uid" minlength="8" maxlength="12">
            <h5 id="uid-invalid">Invalid UserID</h5>
            <h5 id="uid-no-uppercase">You need at least 1 upper case letter.</h5>
            <h5 id="uid-no-lowercase">You need at least 1lower case letter.</h5>
            <h5 id="uid-no-number">You need at least 1 number.</h5>
        </label>
        
        <label>
            First Name:
            <input type="text" id= "fname" name="fname">
            <h5 id="fname-invalid">Invalid fname</h5>
        </label>
        
        <label>
            Last Name:
            <input type="text" id="lname" name="lname">
            <h5 id="lname-invalid">Invalid lname</h5>
        </label>
        
        <label>
            Birthday:
            <input type="date" id="birthday" name="birthday" placeholder="mm/dd/yyyy">
            <h5 id="birthday-invalid">Invalid birthday</h5>
        </label>
        <button>Accept</button>
    </form>
</div>
<div id="chart">
    
</div>
<div>
    <p id="results"></p>
    <p id="age"></p>
</div>

<script>
    const ageDiv = document.getElementById("age")
    const fnameInput = document.getElementById("fname")
    const lnameInput = document.getElementById("lname")
    const birthdayInput = document.getElementById("birthday")
    const resultsDiv = document.getElementById("results")

    function validate(event) {
        event.preventDefault()
        ageDiv.innerHTML = ''
        resultsDiv.innerHTML = ''
        const uidValid = verifyUserID()
        const nameAndBirthdayValid = verifyNameAndBirthday()
        if (nameAndBirthdayValid) {
            const birthday = document.getElementById("birthday").value
            const dateParts = birthday.split("-")
            const birthdate = new Date(parseInt(dateParts[0], 10),
                                    parseInt(dateParts[1], 10) - 1,
                                    parseInt(dateParts[2], 10))
            const daysAlive = dateDiff(birthdate)
            printResults(daysAlive)
        }
    }

    function verifyUserID() {
        const uid = document.getElementById("uid").value
        let hasNumber = false
        let hasUpperCase = false
        let hasLowerCase = false
        
        for(let x of uid) {
            if (!isNaN(x)) { // parseInt() ignored 0
                hasNumber = true 
            }
            else if (x === x.toUpperCase()) {
                hasUpperCase = true
            } 
            else if (x === x.toLowerCase()) {
                hasLowerCase = true
            }
        }
        const userIdValid = hasUpperCase && hasLowerCase && hasNumber
        elementDisplay("uid-no-uppercase", hasUpperCase)
        elementDisplay("uid-no-lowercase", hasLowerCase)
        elementDisplay("uid-no-number", hasNumber)
        elementDisplay("uid-invalid", userIdValid)
        return userIdValid
    }

    function elementDisplay(id, displayNone) {
        document.getElementById(id).style.display = displayNone ? "none" : "block"
    }

    function verifyNameAndBirthday() {
        const fnameValid = fnameInput.value !== ''
        const lnameValid = lnameInput.value !== ''
        const birthdayValid = birthdayInput.value !== ''
        elementDisplay("fname-invalid", fnameValid)
        elementDisplay("lname-invalid", lnameValid)
        elementDisplay("birthday-invalid", birthdayValid)
        const nameAndBirthdayValid = fnameValid && lnameValid && birthdayValid
        return nameAndBirthdayValid
    }

    function dateDiff(birthdate) {
        const today = new Date()
        const millisecondsInDay = 1000 * 60 * 60 * 24
        const daysAlive = (Math.round((today - birthdate) / millisecondsInDay))
        return daysAlive
    }

    function printResults(daysAlive) {
        const fname = fnameInput.value
        const lname = lnameInput.value        
        resultsDiv.innerHTML =
            `${fname} ${lname} you have been breathing for ${daysAlive} days!`
        if (daysAlive < (365*18)){
            ageDiv.innerHTML = "You are probably not old enough to take this class!"
        }   
    }

    let str = ""
    for (let i = 0; i < 21; i++){
        str = str.padStart(i,"x")
        document.write(str + "<br>")
    }
        
</script>

</body>
</html>