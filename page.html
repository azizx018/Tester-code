<!DOCTYPE html>
<html>
<head>
    <title>My Project</title>
    <style>
        body {
            background-color:rgb(26, 26, 102);
            padding: 10px;
            color: white;
        }
        label {
            display:block;
            margin-bottom: 10px;
            padding: 2px;
            
        }
        input {
            display: block;
            width: 180px;
        }
        button {
            background-color:rgb(208, 135, 233);
            padding: 8px; 
            border-radius:5px;
            border-color:white;
            border-width: 1px;
            font-weight: bold;
            cursor:pointer;
        }
        h5 {            
            color:rgb(0, 255, 255);
            display: none;
            margin: 0;
        }
    </style>
</head>
<body>

<div>
    <form onsubmit='validate(event)'>
        <label>
            UserID:
            <input type='text' id ='uid' name='uid' minlength='8' maxlength='12'>
            <h5 id='uid-invalid'>Invalid UserID</h5>
            <h5 id='uid-no-uppercase'>You need at least 1 upper case letter.</h5>
            <h5 id='uid-no-lowercase'>You need at least 1 lower case letter.</h5>
            <h5 id='uid-no-number'>You need at least 1 number.</h5>
        </label>
        
        <label>
            First Name:
            <input type='text' id= 'fname' name='fname'>
            <h5 id='fname-invalid'>Invalid fname</h5>
        </label>
        
        <label>
            Last Name:
            <input type='text' id='lname' name='lname'>
            <h5 id='lname-invalid'>Invalid lname</h5>
        </label>
        
        <label>
            Birthday:
            <input type='date' id='birthday' name='birthday' placeholder='mm/dd/yyyy'>
            <h5 id='birthday-invalid'>Invalid birthday</h5>
        </label>

        <button>Accept</button>
    </form>
</div>
<div>
    <p id='results'></p>
    <p id='age'></p>
</div>

<script>
    const ageDiv = document.getElementById('age')
    const fnameInput = document.getElementById('fname')
    const lnameInput = document.getElementById('lname')
    const birthdayInput = document.getElementById('birthday')
    const resultsDiv = document.getElementById('results')

    function validate(event) {
        event.preventDefault()
        ageDiv.innerHTML = ''
        resultsDiv.innerHTML = ''
        const isUserIdValid = verifyUserID()
        const isNameAndBirthdayValid = verifyNameAndBirthday()
        if (isNameAndBirthdayValid && isUserIdValid) {
            const birthday = birthdayInput.value
            // format from input: yyyy-mm-dd
            const dateParts = birthday.split('-')
            // Date(year, month, day) - all integers
            const birthdate = new Date(parseInt(dateParts[0], 10),
                                    parseInt(dateParts[1], 10) - 1, // Jan is 0
                                    parseInt(dateParts[2], 10))
            const daysBreathing = dateDiff(birthdate)
            printResults(daysBreathing)
        }
    }

    function verifyUserID() {
        const uid = document.getElementById('uid').value
        let hasNumber = false
        let hasUpperCase = false
        let hasLowerCase = false
        
        for(let x of uid) {
            if (!isNaN(x)) { // parseInt() ignored 0
                hasNumber = true 
            }
            else if (x !== x.toLowerCase()) {
                hasUpperCase = true
            } 
            else if (x !== x.toUpperCase()) {
                hasLowerCase = true
            }
        }
        
        const userIdValid = hasUpperCase && hasLowerCase && hasNumber
        elementHide('uid-no-uppercase', hasUpperCase)
        elementHide('uid-no-lowercase', hasLowerCase)
        elementHide('uid-no-number', hasNumber)
        elementHide('uid-invalid', userIdValid)
        return userIdValid
    }

    function elementHide(id, hide) {
        let display = ''
        if (hide) {
            display = 'none'
        } else {
            display = 'block'
        }
        document.getElementById(id).style.display = display
    }

    function verifyNameAndBirthday() {
        const fnameValid = fnameInput.value !== ''
        const lnameValid = lnameInput.value !== ''
        const birthdayValid = birthdayInput.value !== ''
        elementHide('fname-invalid', fnameValid)
        elementHide('lname-invalid', lnameValid)
        elementHide('birthday-invalid', birthdayValid)
        const nameAndBirthdayValid = fnameValid && lnameValid && birthdayValid
        return nameAndBirthdayValid
    }

    function dateDiff(birthdate) {
        const today = new Date()
        const millisecondDifference = today - birthdate
        const millisecondsInDay = 1000 * 60 * 60 * 24
        const daysAlive = Math.round(millisecondDifference / millisecondsInDay)
        return daysAlive
    }

    function printResults(daysAlive) {
        const fname = fnameInput.value
        const lname = lnameInput.value        
        resultsDiv.innerHTML =
            `${fname} ${lname} you have been breathing for ${daysAlive} days!`
        if (daysAlive < (365 * 18)) {
            ageDiv.innerHTML = 'You are probably not old enough to take this class!'
        }   
    }

    for (let i = 1; i < 21; i++){
        let str = ''
        str = str.padStart(i,'x')
        document.write(str + '<br>')
    }
        
</script>

</body>
</html>